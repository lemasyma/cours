<!DOCTYPE html><html lang="fr-FR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://cours-v2.ew.r.appspot.com/query?id=agplfmNvdXJzLXYychULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="IRGPU: Introduction" /><meta property="og:locale" content="fr_FR" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://lemasyma.github.io/cours/posts/irgpu_introduction/" /><meta property="og:url" content="https://lemasyma.github.io/cours/posts/irgpu_introduction/" /><meta property="og:site_name" content="Cours" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-03T10:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="IRGPU: Introduction" /><meta name="google-site-verification" content="mErcVOJcxNzULHvQ99qSclI_DTX0zANqgpsd3jGhkfs" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-10-03T16:45:54+02:00","datePublished":"2021-05-03T10:00:00+02:00","description":"Introduction","headline":"IRGPU: Introduction","mainEntityOfPage":{"@type":"WebPage","@id":"https://lemasyma.github.io/cours/posts/irgpu_introduction/"},"url":"https://lemasyma.github.io/cours/posts/irgpu_introduction/"}</script><title>IRGPU: Introduction | Cours</title><link rel="apple-touch-icon" sizes="180x180" href="/cours/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/cours/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/cours/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/cours/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/cours/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Cours"><meta name="application-name" content="Cours"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/cours/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cours-v2.ew.r.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://cours-v2.ew.r.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/cours/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/cours/" alt="avatar" class="mx-auto"> <img src="/cours/assets/img/favicons/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/cours/">Cours</a></div><div class="site-subtitle font-italic">Certains cours sont en francais, certains sont en anglais, d'autres sont un mix des deux</div></div><ul class="w-100"><li class="nav-item"> <a href="/cours/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/cours/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/cours/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/cours/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/cours/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/lemasyma" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/cours/"> Home </a> </span> <span>IRGPU: Introduction</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>IRGPU: Introduction</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/lemasyma">lemasyma</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-05-03 10:00:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Mon, May 3, 2021, 10:00 AM +0200" >May 3, 2021</em> </span> <span> Updated <em class="timeago" date="2021-10-03 16:45:54 +0200 " data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 3, 2021, 4:45 PM +0200" >Oct 3, 2021</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1180 words"> <em>6 min</em> read</span> <span> <em id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </em> views </span></div></div></div><div class="post-content"><p>Lien de la <a href="https://hackmd.io/@lemasymasa/ryMz0maDu">note Hackmd</a></p><h1 id="agenda">Agenda</h1><ol><li>GPU and architectures (2h)<li>Programming GPUs with CUDA (2h)<li>TP 00 CUDA (3h)<li>Efficient programming with GPU (2h)<li>TP 01 CUDA</ol><h1 id="gpu-and-architectures">GPU and architectures</h1><h2 id="why-using-gpu-">Why using GPU ?<a href="#why-using-gpu-"><i class="fas fa-hashtag"></i></a></h2></h2><div class="alert alert-info" role="alert"><p>On veut faire de la programmation <strong>rapide</strong>.</p></div><p>Un programme rapide est un programme qui <em>consomme moins</em>.</p><div class="alert alert-warning" role="alert"><p>C’est important de consommer moins</p></div><blockquote><p>Ex: nos smartphones consomment enormement d’energie, avoir des programmes qui consomment le moins possible permet d’economiser la batterie</p></blockquote><p>On est aujourd’hui dans l’ere du big data, on veut traiter rapidement un tres gros volume de donnees. Sinon on aurait jamais ete capable d’avoir des techs comme les reseaux de neurones.</p><p>On veut que les programmes s’executent dans un temps borne.</p><blockquote><p>On est pas des gistres… Mais quand meme</p></blockquote><p>On veut pas une reponse d’1h avec des systemes critiques embarques (voitures, fusees, etc.)</p><p><img data-proofer-ignore data-src="https://i.imgur.com/5jy52aK.png" alt="" /></p><h2 id="power-consumption-on-smartphones">Power Consumption on Smartphones<a href="#power-consumption-on-smartphones"><i class="fas fa-hashtag"></i></a></h2></h2><p>CPU is a major source of power in smartphones (even with graphical-oriented app)</p><p><img data-proofer-ignore data-src="https://i.imgur.com/yjVzRpI.png" alt="" /></p><blockquote><p>Une bonne partie de la batterie est consommee par le CPU et GPU</p></blockquote><p>Aujourd’hui, on essaie de tout transferer sur le GPU car ca consomme moins que le CPU</p><h2 id="power-consumption-of-some-processors">Power Consumption of Some Processors<a href="#power-consumption-of-some-processors"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/RzDoEgV.png" alt="" /></p><p><em>Qu’est-ce qu’on remarque du prix par Gigaflops ?</em></p><div class="alert alert-success" role="alert"><p>Le GPU est <strong>beaucoup plus rentable</strong> que le CPU.</p></div><div class="alert alert-danger" role="alert"><p>Tous les calculs ne sont pas basculables du CPU au GPU.</p></div><h1 id="scientific-computing">Scientific Computing</h1><h2 id="a-bit-of-history---the-first-gpu">A bit of history - The first GPU<a href="#a-bit-of-history---the-first-gpu"><i class="fas fa-hashtag"></i></a></h2></h2><p>Ce qui a motive la creation des GPU c’etait la medecine, etc. (meme si le gaming en a prit l’avantage).</p><ul><li>Back in 70’s GPU were for Image Synthesis<li>First GPU: Ikonas RDS-3000<ul><li>A l’epoque: tres difficile de programmer en GPU</ul><li>N. England &amp; M. Witton founded Ikonas Graphics Systems</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/mQviBRh.png" alt="" /></p><h2 id="the-first-gpgpu">The first GPGPU<a href="#the-first-gpgpu"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/YjRHZzv.png" alt="" /></p><div class="alert alert-info" role="alert"><p><strong>General Purpose GPU</strong></p></div><p>First programmable GPU:</p><ul><li>Vertex Shaders: programmable vertex transforms, 32-bits float<ul><li>Pipeline graphics<li>Shaders: etapes de la pipeline qu’on pouvait remplacer<li>A ouvert la voie vers le scientific computic</ul><li>Data-dependent, configurable texturing + register combiners</ul><p>Enabled early GPGPU results:</p><ul><li>Hoff (1999): Voronoi diagrams on NVIDIA TNT2<li>Larsen &amp; MacAllister (2001): first GPU matrix multiplication (8-bit)<li>Rumpf &amp; Strzodka (2001): first GPU PDEs</ul><h2 id="gpgpu-for-physics-simulation-on-geforce-3">GPGPU for physics simulation on Geforce 3<a href="#gpgpu-for-physics-simulation-on-geforce-3"><i class="fas fa-hashtag"></i></a></h2></h2><p>Approximate simulation of natural phenomenon</p><p><img data-proofer-ignore data-src="https://i.imgur.com/OfG7Gl3.png" alt="" /></p><h2 id="geforce-fx-2003-floating-point">GEFORCE FX (2003): floating point<a href="#geforce-fx-2003-floating-point"><i class="fas fa-hashtag"></i></a></h2></h2><p>True programmability enabled broader simulation research</p><ul><li>Ray Tracing<li>Radiosity<li>PDE solvers<li>Physically-base simulation<li>FFT (2003)<li>High-level language: Brook for GPU (2004)</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/vT03I3c.png" alt="" /></p><h2 id="gpgpu-becomes-a-trend-2006">GPGPU becomes a trend (2006)<a href="#gpgpu-becomes-a-trend-2006"><i class="fas fa-hashtag"></i></a></h2></h2><p>2 factors for the massive surge in GPGPU dev:</p><ul><li><strong>Architecture Nvidia G80</strong><ul><li>Dedicated computing mode - threads rather than pixels/vertices<li>General, byte-addressable memory architecture</ul><li><strong>Software support</strong><ul><li>C and C++ languages and compilers for GPUs (spoiler.. it’s <strong>CUDA</strong>)</ul></ul><p><img data-proofer-ignore data-src="https://i.imgur.com/kjsUg1A.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/3kRFHS6.png" alt="" /></p><blockquote><p>Le graphique a droite veut rien dire (c’est du marketing)</p></blockquote><h2 id="2010s">2010’s<a href="#2010s"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="accelerating-discoveries">Accelerating discoveries<a href="#accelerating-discoveries"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-proofer-ignore data-src="https://i.imgur.com/GuYxUDd.png" alt="" /></p><div class="alert alert-danger" role="alert"><p>Without GPUs, supercomputer would like 5x more times</p></div><p><img data-proofer-ignore data-src="https://i.imgur.com/EJioPKf.png" alt="" /></p><p>And data center gave birth to <strong>Deep-Learning</strong></p><p><img data-proofer-ignore data-src="https://i.imgur.com/ANumAzh.png" alt="" /></p><blockquote><p>Les reseaux de neurones existaient deja dans les annees 80 mais on n’avait pas la puissance de calcul avant 2010’s</p></blockquote><h2 id="embedded-systems---the-real-time-constraints">Embedded systems - The <em>real</em>-time constraints<a href="#embedded-systems---the-real-time-constraints"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/82MVjXL.png" alt="" /></p><p>Need both of the 2 worlds:</p><ul><li>Need ultra-performance computing<li>With limited resources</ul><h1 id="gpu-vs-cpu-for-parallelism">GPU vs CPU for parallelism</h1><h2 id="how-to-get-things-done-quicker">How to get things <em>done</em> quicker<a href="#how-to-get-things-done-quicker"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Do less work<li>Do <em>some</em> work better (i.e. the one being he more time-consuming)<li>Do <em>some</em> work at the sane time<li>Distribute work between different workers<ol><li>Choose the most adapted <em>algorithms</em>, and avoid re-computing thing<li>Choose the most adapted <em>data structures</em></ol><li>Parallelism</ol><h2 id="why-parallelism-">Why parallelism ?<a href="#why-parallelism-"><i class="fas fa-hashtag"></i></a></h2></h2><div class="alert alert-info" role="alert"><p><strong>Moore’s law</strong>: processors are <em>not</em> getting twice as powerful every 2 years anymore</p></div><p><img data-proofer-ignore data-src="https://i.imgur.com/V2HJYR3.png" alt="" /></p><ul><li>So the processor is getting smarter<ul><li>Out-of-order execution / dynamic register renaming<li>Speculative execution with branch prediction</ul><li>And the processor is getting super-scalar<ul><li>Executer des choses en meme temps<li>Nos CPUs sont des processeurs super-scalaires</ul></ul><h2 id="toward-data-oritented-programming">Toward data-oritented programming<a href="#toward-data-oritented-programming"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/hkNh64r.png" alt="" /></p><h2 id="the-burger-factory-assembly-line">The burger factory assembly line<a href="#the-burger-factory-assembly-line"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/9CaFieq.png" alt="" /></p><p><em>How to make several sandwiches as fast as possible ?</em></p><ul><li>Avoir plusieurs personnes qui travaillent en meme temps sur le meme sandwich et vont executer les taches independantes en meme temps, avoir un worker maitre qui s’occupe d’assembler tout<li>Avoir plusieurs workers qui travaillent en meme temps sur des sandwichs differents<li>Mix entre les 2 strategies precedente: un worker qui peut bosser sur un sandwich ou plusieurs en meme temps<li>Pipeline: un worker fait une etape et passe le sandwich a un autre worker<li>Un worker a plusieurs bras</ul><p>A prendre en compte:</p><ul><li>La latence<li>Le debit</ul><p>Avec la 1ere strategie: 2 cycles</p><ul><li>optimisation en latence et debit<li>Pas la plus efficace car etape de synchronisation</ul><p>Avec la 2e strategie</p><ul><li>Optimisation en debit mais pas en latence</ul><p>Avec la 3e strategie:</p><ul><li>Tres lourd niveau synchronisation</ul><h2 id="data-oriented-programming-parallelism">Data-oriented programming parallelism<a href="#data-oriented-programming-parallelism"><i class="fas fa-hashtag"></i></a></h2></h2><p>Flynn’s Taxonomy</p><p><img data-proofer-ignore data-src="https://i.imgur.com/rl9WOdu.png" alt="" /></p><ul><li>SISD: no parallelism<li>SIMD: same instruction on data group (vector)<li>MISD: rare, mostly used for fault tolerant code<li>MIMD: usual parallel mode (multithreading)<li>SPMT: Single Programm Multiple Thread<ul><li>Execute le meme programme</ul></ul><h3 id="optimize-for-latency-mimd-with-collaborative-workers">Optimize for latency (MIMD with collaborative workers)<a href="#optimize-for-latency-mimd-with-collaborative-workers"><i class="fas fa-hashtag"></i></a></h3></h3><p>4 <strong>super-workers</strong> (4 CPU cores) collaborate to make 1 sandwich</p><ul><li>Manu gets the bread and wait for the others</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/1iAvEme.png" alt="" /></p><p>Time to make 4 sandwicches: $s$ (400% speed-up)</p><h3 id="optimize-for-throughtput-mimd-horizontal-with-multiple-jobs">Optimize for throughtput (MIMD Horizontal with multiple jobs)<a href="#optimize-for-throughtput-mimd-horizontal-with-multiple-jobs"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-proofer-ignore data-src="https://i.imgur.com/piN1o3u.png" alt="" /></p><p>Time to make 4 sandwiches: <em>s</em> (400% speed-up)</p><h3 id="optimize-for-throughput-mimd-vertical-pipelining">Optimize for throughput (MIMD Vertical Pipelining)<a href="#optimize-for-throughput-mimd-vertical-pipelining"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-proofer-ignore data-src="https://i.imgur.com/aY23s66.png" alt="" /></p><h3 id="optimize-for-throughput-simd-dlp">Optimize for throughput (SIMD DLP)<a href="#optimize-for-throughput-simd-dlp"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-proofer-ignore data-src="https://i.imgur.coml4iW3P.png" alt="" /></p><div class="alert alert-success" role="alert"><p>Un seul optimise en latence</p></div><h2 id="more-cores-is-trendy">More cores is trendy<a href="#more-cores-is-trendy"><i class="fas fa-hashtag"></i></a></h2></h2><p>Data-oriented design have changed the way we make processors (even CPUs)</p><ul><li>Lower clock rate<li>Large vector-size, more vector-oriented ISA<li>More cores (processing units)</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/PKtI2Cc.png" alt="" /></p><div class="alert alert-info" role="alert"><p>Parallelisme: SIMD</p></div><p>Depuis 2005/2006, on a des “faux” coeurs pour faire du multi-threading</p><p><img data-proofer-ignore data-src="https://i.imgur.com/MdzsNoT.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/fB4ikRi.png" alt="" /></p><h2 id="cpu-vs-gpu-performance">CPU vs GPU performance<a href="#cpu-vs-gpu-performance"><i class="fas fa-hashtag"></i></a></h2></h2><p>And you see it with HPC apps: <img data-proofer-ignore data-src="https://i.imgur.com/9aLv19X.png" alt="" /></p><h2 id="towards-heterogeneous-architectures">Towards Heterogeneous Architectures<a href="#towards-heterogeneous-architectures"><i class="fas fa-hashtag"></i></a></h2></h2><p>But don’t forget, you may need to optimize both <strong>latency</strong> and <strong>throughput</strong></p><p>What is the bounds speedup attainable on a parallel machine with a program which is parallelizable at $P\%$ (i.e. must run sequentially for $(1-P)$)</p><p><img data-proofer-ignore data-src="https://i.imgur.com/IcHh1Nf.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/jjnaj9M.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/5CoCqIB.png" alt="" /></p><div class="alert alert-success" role="alert"><p>Utiliser la bonne architecture pour le bon travail</p></div><p><img data-proofer-ignore data-src="https://i.imgur.com/Qun7G6L.png" alt="" /></p><h1 id="gpu-vs-cpu-architectures">GPU vs CPU architectures</h1><h2 id="its-all-about-the-data-the-cpu">It’s all about the data… The CPU:<a href="#its-all-about-the-data-the-cpu"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/bF0AHjZ.png" alt="" /></p><ul><li>optimized for low-latency <strong>access</strong> (many memory caches)<li>Control logic for out-of-order and speculative execution</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/WzKN3uI.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/ZHQfywy.png" alt="" /></p><h2 id="its-all-about-data-the-gpu">It’s all about data.. the GPU:<a href="#its-all-about-data-the-gpu"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/jIoDCAp.png" alt="" /></p><h2 id="hiding-latency-with-thread-parallelism--pipelining">Hiding latency with thread parallelism &amp; pipelining<a href="#hiding-latency-with-thread-parallelism--pipelining"><i class="fas fa-hashtag"></i></a></h2></h2><p>So… you want to hide the latency of getting data from from global memory… how ?</p><p>1 CPU Core: <img data-proofer-ignore data-src="https://i.imgur.com/38NUipK.png" alt="" /></p><p>1 GPU SMP (Streaming Multiprocessor) <img data-proofer-ignore data-src="https://i.imgur.com/DCwroWs.png" alt="" /></p><p>CPU:</p><ul><li>low-latency memory to get data ready<li>each thread context switch has a cost</ul><p>GPU:</p><ul><li>memory latency hidden by <strong>pipelining</strong><li>context switch is free</ul><p>Latency hiding:</p><ul><li>= do other operations when waiting for data<li>= having a lot of parallelism<li>= having a lot of data<li>will run faster<li>but not faster than the peak<li>what is the peak btw ?</ul><div class="alert alert-info" role="alert"><p><strong>Peak</strong>:</p><ol><li>Peak de la memoire<ul><li>Donnee par un nombre</ul><li>Peak du compute<ul><li>Nombre d’instructions qu’on peut executer par secondes</ul></ol></div><h2 id="its-all-about-data-littles-law">It’s all about data… Little’s law”<a href="#its-all-about-data-littles-law"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/U5Bcw6d.png" alt="" /></p><p>La latence est typiquement la longueur de la pipeline</p><h2 id="hiding-latency">Hiding latency<a href="#hiding-latency"><i class="fas fa-hashtag"></i></a></h2></h2><p>With thread parallelism &amp; pipelining</p><p><em>Note that pipeline exists on CPUs (cycle de Von Neumann)</em></p><p><img data-proofer-ignore data-src="https://i.imgur.com/Z838j2O.png" alt="" /></p><h2 id="more-about-forms-of-parallelism-the-why">More about forms of parallelism (the why!)<a href="#more-about-forms-of-parallelism-the-why"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/Ok9TNLF.png" alt="" /></p><h2 id="more-about-forms-of-parallelism-the-how">More about forms of parallelism (the how!)<a href="#more-about-forms-of-parallelism-the-how"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/XAU5irO.png" alt="" /> <img data-proofer-ignore data-src="https://i.imgur.com/ohaIgXG.png" alt="" /> <img data-proofer-ignore data-src="https://i.imgur.com/z18k7lR.png" alt="" /></p><p><em>Pourquoi on a un TLP horizontal sur les CPUs ?</em> Multicoeurs <em>Pourquoi on a un TLP vertical sur les CPUs ?</em> Les hypercoeurs (coeurs logiques). Ce ne sont pas des vrais coeurs mais des threads capables de switch sur les coeurs.</p><h2 id="extracting-parallelism">Extracting parallelism<a href="#extracting-parallelism"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/dgwbeju.png" alt="" /></p><h2 id="parallel-architectures-and-parallelism">Parallel architectures and parallelism<a href="#parallel-architectures-and-parallelism"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/fEMA6gi.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/A2TGqEe.png" alt="" /></p><ul><li>All processors use hardware to turn parallelsim into performance</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/cours/categories/image-s8/'>Image S8</a>, <a href='/cours/categories/irgpu/'>IRGPU</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/cours/tags/image/" class="post-tag no-text-decoration" >Image</a> <a href="/cours/tags/s8/" class="post-tag no-text-decoration" >S8</a> <a href="/cours/tags/irgpu/" class="post-tag no-text-decoration" >IRGPU</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=IRGPU: Introduction - Cours&url=https://lemasyma.github.io/cours/posts/irgpu_introduction/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=IRGPU: Introduction - Cours&u=https://lemasyma.github.io/cours/posts/irgpu_introduction/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=IRGPU: Introduction - Cours&url=https://lemasyma.github.io/cours/posts/irgpu_introduction/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/cours/posts/ocvx_norme/">OCVX: Norme</a><li><a href="/cours/posts/imed2_tp3/">IMED2: TP3</a><li><a href="/cours/posts/prsta_revisions_1/">PRSTA: Revisions 1</a><li><a href="/cours/posts/prsta_td5/">PRSTA: TD 5</a><li><a href="/cours/posts/prsta_td4/">PRSTA: TD 4</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/cours/tags/image/">Image</a> <a class="post-tag" href="/cours/tags/s8/">S8</a> <a class="post-tag" href="/cours/tags/s9/">S9</a> <a class="post-tag" href="/cours/tags/tronc-commun/">tronc commun</a> <a class="post-tag" href="/cours/tags/scia/">SCIA</a> <a class="post-tag" href="/cours/tags/s6/">S6</a> <a class="post-tag" href="/cours/tags/shannon/">Shannon</a> <a class="post-tag" href="/cours/tags/cama/">CAMA</a> <a class="post-tag" href="/cours/tags/loi/">loi</a> <a class="post-tag" href="/cours/tags/rvau/">RVAU</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/cours/posts/irgpu_getting-started/"><div class="card-body"> <em class="timeago small" date="2021-05-03 14:00:00 +0200" >May 3, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>IRGPU: Getting started with CUDA</h3><div class="text-muted small"><p> Lien de la note Hackmd CUDA overview What is CUDA ? A product It enables to use NVidia GPUs for computation A C/C++ variant Mostly C++ 15 compatible, with extensions and also some restri...</p></div></div></a></div><div class="card"> <a href="/cours/posts/irgpu_patterns/"><div class="card-body"> <em class="timeago small" date="2021-05-05 14:00:00 +0200" >May 5, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>IRGPU: Patterns for massively parallel programming</h3><div class="text-muted small"><p> Lien de la note Hackmd IRGPU: Patterns for massively parallel programming Programming patterns &amp;amp; memory optimizations The programming patterns Map Map + Local reduction Reduction Sc...</p></div></div></a></div><div class="card"> <a href="/cours/posts/ocvx_hyperplan/"><div class="card-body"> <em class="timeago small" date="2021-05-07 10:00:00 +0200" >May 7, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OCVX: Hyperplan d'appui</h3><div class="text-muted small"><p> Lien de la note Hackmd Rappels Hyperplan d’appui a une partie $A$ de $\mathbb R^n$ en un point $p\in A$, est un hyperplan affine de $\mathbb R^n$ qui laisse $A$ dans un des deux demi-espaces de...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/cours/posts/pfee_smiths/" class="btn btn-outline-primary" prompt="Older"><p>PFEE - Sujet 6.1 et 6.2: Smiths group</p></a> <a href="/cours/posts/irgpu_getting-started/" class="btn btn-outline-primary" prompt="Newer"><p>IRGPU: Getting started with CUDA</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/lemasyma">lemasyma</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/cours/tags/image/">Image</a> <a class="post-tag" href="/cours/tags/s8/">S8</a> <a class="post-tag" href="/cours/tags/s9/">S9</a> <a class="post-tag" href="/cours/tags/tronc-commun/">tronc commun</a> <a class="post-tag" href="/cours/tags/scia/">SCIA</a> <a class="post-tag" href="/cours/tags/s6/">S6</a> <a class="post-tag" href="/cours/tags/shannon/">Shannon</a> <a class="post-tag" href="/cours/tags/cama/">CAMA</a> <a class="post-tag" href="/cours/tags/loi/">loi</a> <a class="post-tag" href="/cours/tags/rvau/">RVAU</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/cours/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/cours/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/cours/assets/js/dist/post.min.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" }, tagSide: "right" }, tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], displayMath: [ ['$$','$$'], ["\\[","\\]"] ], processEscapes: true }, CommonHTML: { linebreaks: { automatic: true } }, "HTML-CSS": { linebreaks: { automatic: true } }, SVG: { linebreaks: { automatic: true } } }); MathJax.Hub.Register.StartupHook("TeX AMSmath Ready", function () { MathJax.InputJax.TeX.Stack.Item.AMSarray.Augment({ clearTag() { if (!this.global.notags) { this.super(arguments).clearTag.call(this); } } }); }); </script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script type="text/javascript" charset="utf-8" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/cours/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-PVWXSNG5J8"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-PVWXSNG5J8'); }); </script>
