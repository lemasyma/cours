<!DOCTYPE html><html lang="fr-FR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://cours-v2.ew.r.appspot.com/query?id=agplfmNvdXJzLXYychULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="DLIM: Reseaux neuronaux convolutifs" /><meta property="og:locale" content="fr_FR" /><meta name="description" content="Lien de la note Hackmd" /><meta property="og:description" content="Lien de la note Hackmd" /><link rel="canonical" href="https://lemasyma.github.io/cours/posts/dlim_res_neurones_convolutif/" /><meta property="og:url" content="https://lemasyma.github.io/cours/posts/dlim_res_neurones_convolutif/" /><meta property="og:site_name" content="Cours" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-08T14:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="DLIM: Reseaux neuronaux convolutifs" /><meta name="google-site-verification" content="mErcVOJcxNzULHvQ99qSclI_DTX0zANqgpsd3jGhkfs" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-11-10T14:35:52+01:00","datePublished":"2021-11-08T14:00:00+01:00","description":"Lien de la note Hackmd","headline":"DLIM: Reseaux neuronaux convolutifs","mainEntityOfPage":{"@type":"WebPage","@id":"https://lemasyma.github.io/cours/posts/dlim_res_neurones_convolutif/"},"url":"https://lemasyma.github.io/cours/posts/dlim_res_neurones_convolutif/"}</script><title>DLIM: Reseaux neuronaux convolutifs | Cours</title><link rel="apple-touch-icon" sizes="180x180" href="/cours/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/cours/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/cours/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/cours/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/cours/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Cours"><meta name="application-name" content="Cours"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/cours/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cours-v2.ew.r.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://cours-v2.ew.r.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/cours/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/cours/" alt="avatar" class="mx-auto"> <img src="/cours/assets/img/favicons/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/cours/">Cours</a></div><div class="site-subtitle font-italic">Certains cours sont en francais, certains sont en anglais, d'autres sont un mix des deux</div></div><ul class="w-100"><li class="nav-item"> <a href="/cours/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/cours/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/cours/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/cours/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/cours/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/lemasyma" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/cours/"> Home </a> </span> <span>DLIM: Reseaux neuronaux convolutifs</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>DLIM: Reseaux neuronaux convolutifs</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/lemasyma">lemasyma</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-11-08 14:00:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 8, 2021, 2:00 PM +0100" >Nov 8, 2021</em> </span> <span> Updated <em class="timeago" date="2021-11-10 14:35:52 +0100 " data-toggle="tooltip" data-placement="bottom" title="Wed, Nov 10, 2021, 2:35 PM +0100" >Nov 10, 2021</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="630 words"> <em>3 min</em> read</span> <span> <em id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </em> views </span></div></div></div><div class="post-content"><p>Lien de la <a href="https://hackmd.io/@lemasymasa/B1-YkiLwt">note Hackmd</a></p><h1 id="un-reseau-de-neurones-convolutif">Un reseau de neurones convolutif</h1><p><img data-proofer-ignore data-src="https://i.imgur.com/Gusjhh3.png" alt="" /></p><h2 id="le-but-est-dextraire-les-caracteristiques">Le but est d’extraire les caracteristiques<a href="#le-but-est-dextraire-les-caracteristiques"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/HXXmFvh.jpg" alt="" /></p><h2 id="les-formules-de-convolution">Les formules de convolution<a href="#les-formules-de-convolution"><i class="fas fa-hashtag"></i></a></h2></h2><p>Continue 1D:</p>\[(f * g)(x) = \int_{-\infty}^{+\infty}f(x-t)g(t)dt = \int_{-\infty}^{+\infty} f(t)g(x-t)dt\]<p>Discrete 2D:</p>\[(f*\omega)(x,y) = \sum_{dx=-a}^a\sum_{dy=-b}^b\omega(a + dx, b + dy)f(x + dx, y+dy)\]<p>$f$ est l’aimeg, $\omega$ le noyau, son support est $[-a,a]\times[-b, b]$</p><p>Exemple de noyaux $\omega$ (WP Noyau_(traitement_d’image)):</p><p><img data-proofer-ignore data-src="https://i.imgur.com/X1325di.png" alt="" /></p><h1 id="conv2d">Conv2D</h1><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">kl</span><span class="p">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
</pre></table></code></div></div><p>L’image d’entree a 3 canaux -&gt; chaque filtre a $5\times5\times 3 + 1$ poids L’image de sortie a 4 canaux, elle pert 4 pixels dans chaque direction</p><h2 id="en-details--stride--padding--same">En details + stride + padding = ‘same’<a href="#en-details--stride--padding--same"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">kernel_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">stride</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">padding</span> <span class="o">=</span> <span class="s">'same'</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/do3CIuS.gif" alt="" /></p><ul><li>Stride: une facon de reduire la taille d’une image<li>padding = ‘same’: la sortie a la meme taille</ul><h2 id="convolution-a-trous">Convolution a trous<a href="#convolution-a-trous"><i class="fas fa-hashtag"></i></a></h2></h2><p>En anglais: <em>atrous convolution</em></p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dilatation_rate</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/yDxMfxd.gif" alt="" /></p><div class="alert alert-success" role="alert"><p>Couvre la meme surface qu’un noyau $5\times 5$, ou que $2$ convolutions $3\times 3$ a la suite, mais pour un cout moins cher (en poids)</p></div><p>Ne reduit pas la taille de l’image (padding = <code class="language-plaintext highlighter-rouge">same</code>)</p><h2 id="convolution-separee">Convolution separee<a href="#convolution-separee"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><strong>spatiale</strong>: une conv $2D\to1$ conv. $1D$<li><strong>profondeur</strong>: $N$ conv $2D$ sur $M$ couches $\to$ $M$ conv $2D$ puis $N$ conv $1D$</ul><p><strong>Convolution separeee spatiale</strong></p><p><img data-proofer-ignore data-src="https://i.imgur.com/CiDOpZd.png" alt="" /></p><p>En pratique on fait:</p><p><img data-proofer-ignore data-src="https://i.imgur.com/StH7rLK.png" alt="" /></p><p><strong>Conv separee en profondeur</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">kl</span><span class="p">.</span><span class="n">SeparableConv2D</span>
</pre></table></code></div></div><p>Ici 3 couches:</p><ul><li>$3$ conv $2D$ + $4$ conv $1D$<li>$4$ couches en sortie</ul><p>Gain de calcul important perte de representation $\to$ utilise</p><p><a href="https://arxiv.org/abs/1704.04861">MobileNet</a></p><h2 id="la-convolution-transposee-ou-deconvolution">La convolution transposee (ou deconvolution)<a href="#la-convolution-transposee-ou-deconvolution"><i class="fas fa-hashtag"></i></a></h2></h2><div class="alert alert-info" role="alert"><p><em>Convolution</em>: <strong>concentre</strong> en un pixel un bloc de pixel (fois un noyau)</p></div><div class="alert alert-info" role="alert"><p><em>Conv transposee</em>: <strong>distribue</strong> un pixel (fois un noyau) a un bloc de pixel</p></div><p><img data-proofer-ignore data-src="https://i.imgur.com/RBr2eiZ.png" alt="" /></p><p>Mathematiquement les deux sont des convolutions mais la conv. transposee a pour but de simuler l’operation inverse de la conv</p>\[\begin{aligned} \text{propagation conv transposee} &amp;\leftrightarrow \text{retro-propagation conv}\\ \text{retro-propagation conv. transposee} &amp;\leftrightarrow\text{propagation conv.} \end{aligned}\]<h2 id="trucs-darchitecture">Trucs d’architecture<a href="#trucs-darchitecture"><i class="fas fa-hashtag"></i></a></h2></h2><div class="alert alert-danger" role="alert"><p><strong>Pooling</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">kl</span><span class="p">.</span><span class="n">MaxPooling2d</span><span class="p">(</span><span class="n">pool_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/jiVaceA.png" alt="" /></p><p>Si on veut augmenter le nombre de couches il faut diminuer la taille de l’image sinon BOOM</p><p>On veut une vision multi-echelle il faut diminuer la taille de l’image + ponts.</p><p>L’inverse du <em>pooling</em> est kl</p></div><div class="alert alert-danger" role="alert"><p><strong>Ponts</strong></p><p>La grande astuce de ResNet qui leur a permis de tout gagner</p><p><img data-proofer-ignore data-src="https://i.imgur.com/geGwGQT.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/gsMUa9w.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/0JZRffW.png" alt="" /></p><ul><li>vert $\to$<li>rouge $\leftarrow$</ul><p>Prog. et retro-prog.</p><p>Lors de la retropropagation l’erreur prend le pont et les convolutions $\to$ les premieres couches sont corrigees</p></div><div class="alert alert-danger" role="alert"><p><strong>Dropout ou BatchNormalization</strong></p><p>Pas besoin de dropout si BatchNormalization</p><p><img data-proofer-ignore data-src="https://i.imgur.com/LKglSCh.png" alt="" /></p><p>Evite que les poids importants en bloquent d’autres</p><p><img data-proofer-ignore data-src="https://i.imgur.com/a6ZPQiZ.png" alt="" /></p><p>Apres convolution Avant fonction d’activation Reduit le besoin de normaliser les donnees</p></div><h1 id="types-de-problemes-en-vision">Types de problemes en vision</h1><p>Semantic segmentation</p><p><img data-proofer-ignore data-src="https://i.imgur.com/T8Yjc0Z.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/Fe8XbHm.jpg" alt="" /></p><ul><li>Classification<li>Classification + localisation<li>Object detection<li>Instance segmentation<ul><li>Celle qu’on va faire</ul></ul><h2 id="u-net-2015">U-net (2015)<a href="#u-net-2015"><i class="fas fa-hashtag"></i></a></h2></h2><p>Separation semantique d’images medicales</p><p><img data-proofer-ignore data-src="https://i.imgur.com/TIXfKwb.png" alt="" /></p><p>Multi-echelle</p><p><em>Notre projet aujourd’hui !</em></p><p>Copy &amp; crops: ce sont des PONTS</p><ul><li>Ca sert a faire des concatenations</ul><h1 id="fonctions-derreur-pour-la-segmentation">Fonctions d’erreur pour la segmentation</h1><p>Si chaque image de sortie represente les pixels appartenant a la classe $k$, alors on peut finir avec un <code class="language-plaintext highlighter-rouge">softmax</code>: $y+k = e^{z_k}/\sum_{i}e^{z_i}$</p><ul><li>Erreur quadratique <code class="language-plaintext highlighter-rouge">mse</code>: pente douce, pas d’information d’exclusion<li>Entropie croisee: $E=-\sum_kt\log y_k+(1-t_k)\log(1-y_k)$<ul><li><code class="language-plaintext highlighter-rouge">binary_crossentropy</code> avec $t_k=0$ ou $1$<li><code class="language-plaintext highlighter-rouge">categorical_crossentropy</code> avec resultats sous la forme $[0,0,..,1,..,0]$ pour indiquer la classe $k$<li><code class="language-plaintext highlighter-rouge">sparse_categorical_crossentropy</code> avec les classes indiques par des entier</ul></ul><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">y_true</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="c1">#image 2x2 with 3 categories
</span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="p">.</span><span class="mi">01</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="c1">#proba for each category
</span>         <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]]</span> <span class="c1">#for each pixel
</span><span class="n">loss</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">losses</span><span class="p">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">()</span>
<span class="n">loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">).</span><span class="n">numpy</span><span class="p">()</span>
</pre></table></code></div></div><div class="alert alert-danger" role="alert"><p><strong>Focal loss</strong></p>\[E_{FL} = -\sum_k t_k(1-y_k)^{\gamma}+(1-t_k)(1-y_k)^{\gamma}\log(1-y_k)\]<p>Comme la pente du log est forte, elle favorise les cas simples a detecter. On peut ecraser la courbe de $(1-\gamma_k)$ pour aider à trouver les cas difficiles.</p><p><img data-proofer-ignore data-src="https://i.imgur.com/L6XTOML.png" alt="" /></p></div><h1 id="augmenter-le-nombre-de-donnees">Augmenter le nombre de donnees</h1><p>Souvent c’est bien utile, en particulier lorsqu’on manque de donnees.</p><p><img data-proofer-ignore data-src="https://i.imgur.com/7dtm6dZ.png" alt="" /></p><p>Parfois ca rend la tache plus difficile et ca ne marche pas.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">ImageDataGenerator</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/cours/categories/image-s9/'>Image S9</a>, <a href='/cours/categories/dlim/'>DLIM</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/cours/tags/image/" class="post-tag no-text-decoration" >Image</a> <a href="/cours/tags/s9/" class="post-tag no-text-decoration" >S9</a> <a href="/cours/tags/dlim/" class="post-tag no-text-decoration" >DLIM</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=DLIM: Reseaux neuronaux convolutifs - Cours&url=https://lemasyma.github.io/cours/posts/dlim_res_neurones_convolutif/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=DLIM: Reseaux neuronaux convolutifs - Cours&u=https://lemasyma.github.io/cours/posts/dlim_res_neurones_convolutif/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=DLIM: Reseaux neuronaux convolutifs - Cours&url=https://lemasyma.github.io/cours/posts/dlim_res_neurones_convolutif/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/cours/posts/ocvx_norme/">OCVX: Norme</a><li><a href="/cours/posts/imed2_tp3/">IMED2: TP3</a><li><a href="/cours/posts/prsta_revisions_1/">PRSTA: Revisions 1</a><li><a href="/cours/posts/prsta_td5/">PRSTA: TD 5</a><li><a href="/cours/posts/prsta_td4/">PRSTA: TD 4</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/cours/tags/image/">Image</a> <a class="post-tag" href="/cours/tags/s8/">S8</a> <a class="post-tag" href="/cours/tags/s9/">S9</a> <a class="post-tag" href="/cours/tags/tronc-commun/">tronc commun</a> <a class="post-tag" href="/cours/tags/scia/">SCIA</a> <a class="post-tag" href="/cours/tags/s6/">S6</a> <a class="post-tag" href="/cours/tags/shannon/">Shannon</a> <a class="post-tag" href="/cours/tags/cama/">CAMA</a> <a class="post-tag" href="/cours/tags/loi/">loi</a> <a class="post-tag" href="/cours/tags/rvau/">RVAU</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/cours/posts/dlim_deepfake/"><div class="card-body"> <em class="timeago small" date="2021-11-29 14:00:00 +0100" >Nov 29, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DLIM: Deepfake</h3><div class="text-muted small"><p> Lien de la note Hackmd Deepfake Les GAN permettent de creer de faux surprenat avec des reseaux profonds (d’ou Deepfakes) Creation de visage (StyleGAN) Fausse video comme celle de Poutine so...</p></div></div></a></div><div class="card"> <a href="/cours/posts/dlim_face_detection/"><div class="card-body"> <em class="timeago small" date="2021-11-22 14:00:00 +0100" >Nov 22, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DLIM: Face detection</h3><div class="text-muted small"><p> Lien de la note Hackmd Face detection in general Why is facre detection so difficult ? Pose (Out-of-Plane Rotation) and orientation (In-Plane Rotation) Presence or absence of structural compon...</p></div></div></a></div><div class="card"> <a href="/cours/posts/imed2_tp3/"><div class="card-body"> <em class="timeago small" date="2021-11-25 09:00:00 +0100" >Nov 25, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>IMED2: TP3</h3><div class="text-muted small"><p> Reconstruction tomographique (2/3) Vous avez tous les outils pour comprendre la reconstruction tomographique 2D en géométrie parallèle dans le cadre idéal : à partir des lignes intégrales (transfo...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/cours/posts/tvid_pixel_a_image/" class="btn btn-outline-primary" prompt="Older"><p>TVID: Du pixel a l'ecran</p></a> <a href="/cours/posts/tnsi_traitement_num_signal/" class="btn btn-outline-primary" prompt="Newer"><p>TNSI: Traitement numerique du signal</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/lemasyma">lemasyma</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/cours/tags/image/">Image</a> <a class="post-tag" href="/cours/tags/s8/">S8</a> <a class="post-tag" href="/cours/tags/s9/">S9</a> <a class="post-tag" href="/cours/tags/tronc-commun/">tronc commun</a> <a class="post-tag" href="/cours/tags/scia/">SCIA</a> <a class="post-tag" href="/cours/tags/s6/">S6</a> <a class="post-tag" href="/cours/tags/shannon/">Shannon</a> <a class="post-tag" href="/cours/tags/cama/">CAMA</a> <a class="post-tag" href="/cours/tags/loi/">loi</a> <a class="post-tag" href="/cours/tags/rvau/">RVAU</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/cours/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/cours/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/cours/assets/js/dist/post.min.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" }, tagSide: "right" }, tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], displayMath: [ ['$$','$$'], ["\\[","\\]"] ], processEscapes: true }, CommonHTML: { linebreaks: { automatic: true } }, "HTML-CSS": { linebreaks: { automatic: true } }, SVG: { linebreaks: { automatic: true } } }); MathJax.Hub.Register.StartupHook("TeX AMSmath Ready", function () { MathJax.InputJax.TeX.Stack.Item.AMSarray.Augment({ clearTag() { if (!this.global.notags) { this.super(arguments).clearTag.call(this); } } }); }); </script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script type="text/javascript" charset="utf-8" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/cours/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-PVWXSNG5J8"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-PVWXSNG5J8'); }); </script>
