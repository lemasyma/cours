<!DOCTYPE html><html lang="fr-FR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="pv-proxy-endpoint" content="https://cours-v2.ew.r.appspot.com/query?id=agplfmNvdXJzLXYychULEghBcGlRdWVyeRiAgIDo14eBCgw"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="MLRF: Lecture 02" /><meta property="og:locale" content="fr_FR" /><meta name="description" content="Lecture 02" /><meta property="og:description" content="Lecture 02" /><link rel="canonical" href="https://lemasyma.github.io/cours/posts/mlrf_second_course/" /><meta property="og:url" content="https://lemasyma.github.io/cours/posts/mlrf_second_course/" /><meta property="og:site_name" content="Cours" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-21T10:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="MLRF: Lecture 02" /><meta name="google-site-verification" content="mErcVOJcxNzULHvQ99qSclI_DTX0zANqgpsd3jGhkfs" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-10-03T16:45:54+02:00","datePublished":"2021-05-21T10:00:00+02:00","description":"Lecture 02","headline":"MLRF: Lecture 02","mainEntityOfPage":{"@type":"WebPage","@id":"https://lemasyma.github.io/cours/posts/mlrf_second_course/"},"url":"https://lemasyma.github.io/cours/posts/mlrf_second_course/"}</script><title>MLRF: Lecture 02 | Cours</title><link rel="apple-touch-icon" sizes="180x180" href="/cours/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/cours/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/cours/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/cours/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/cours/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Cours"><meta name="application-name" content="Cours"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/cours/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cours-v2.ew.r.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://cours-v2.ew.r.appspot.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/cours/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/cours/" alt="avatar" class="mx-auto"> <img src="/cours/assets/img/favicons/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/cours/">Cours</a></div><div class="site-subtitle font-italic">Certains cours sont en francais, certains sont en anglais, d'autres sont un mix des deux</div></div><ul class="w-100"><li class="nav-item"> <a href="/cours/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/cours/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/cours/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/cours/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/cours/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/lemasyma" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/cours/"> Home </a> </span> <span>MLRF: Lecture 02</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>MLRF: Lecture 02</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/lemasyma">lemasyma</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-05-21 10:00:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Fri, May 21, 2021, 10:00 AM +0200" >May 21, 2021</em> </span> <span> Updated <em class="timeago" date="2021-10-03 16:45:54 +0200 " data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 3, 2021, 4:45 PM +0200" >Oct 3, 2021</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1330 words"> <em>7 min</em> read</span> <span> <em id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </em> views </span></div></div></div><div class="post-content"><p>Lien de la <a href="https://hackmd.io/@lemasymasa/SyZvLkrYO">note Hackmd</a></p><h1 id="agenda-for-lecture-2">Agenda for lecture 2</h1><ol><li>Introduction<li>Global image descriptors<li>Clustering<li>Local feature detectors</ol><h1 id="introduction">Introduction</h1><h2 id="summary-of-last-lecture">Summary of last lecture<a href="#summary-of-last-lecture"><i class="fas fa-hashtag"></i></a></h2></h2><p>Machine learning</p><ul><li>Machine learning = searching for the best model in a hypothesis space<li>Inductive machine learning, optimization-based<li>Inductive bias, bias/vairance compromise<li>Supervised, reinforcement, unsupervised learning<li>Regression, classification, density estimation<li>Model validation: test generalisation, separate/decorrelate test &amp; training sets</ul><p>Template matching</p><ul><li>Sum of squared differences $(T-I)^2$, or correlation-based methodes ($T\times I$)<li>Normalization needed for correlation-based methods<li>Tolerates translation and small noise, but not rotation, intensity shift, …</ul><h2 id="debrief-of-practice-session-1">Debrief of practice session 1<a href="#debrief-of-practice-session-1"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>PS1 content</strong></p><ol><li>Jupyter tricks<li>NumPy reminders<li>Intro to image manipulations<li>Twin it! part 1: template matching<li>(Bonus level: segmentation)</ol><h3 id="take-home-messages">Take home messages<a href="#take-home-messages"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-proofer-ignore data-src="https://i.imgur.com/igVepmo.png" alt="" /></p><blockquote><p>How annoying was it to <em>manually adjust color thresholds</em> to select the duck ? How could have we <em>automated</em> it ?</p></blockquote><p>Results with method <code class="language-plaintext highlighter-rouge">SQDIFF_NORMED</code> (lower is better)</p><p><img data-proofer-ignore data-src="https://i.imgur.com/dS4iuLi.png" alt="" /></p><blockquote><p>Strengths and weaknesses of <em>template matching</em> for the <em>Twin It!</em> case ? Effects of <em>normalization</em> ?</p></blockquote><h2 id="next-practice-session">Next practice session<a href="#next-practice-session"><i class="fas fa-hashtag"></i></a></h2></h2><p><em>Twin it!</em> again, with a slightly more elaborated approach</p><ol><li>Pre-selected bubbles based on their colors $\Rightarrow$ color histograms</ol><p><img data-proofer-ignore data-src="https://i.imgur.com/dIXqJBc.png" alt="" /></p><h3 id="color-histogram-in-details">Color histogram: in details<a href="#color-histogram-in-details"><i class="fas fa-hashtag"></i></a></h3></h3><p>1.1 Color quantization: reduce the colors of the bubbles</p><p><img data-proofer-ignore data-src="https://i.imgur.com/PU2Lk3G.png" alt="" /></p><p>1.2. Compute the color histogram of each bubble</p><p><img data-proofer-ignore data-src="https://i.imgur.com/rG7g1OL.png" alt="" /></p><p>1.3. Compute the distance matrix between each bubble, using its color histogram</p><p><img data-proofer-ignore data-src="https://i.imgur.com/AqJonwW.png" alt="" /></p><p>1.4 Visualize the bubbles in an interesting way using hierarchical clustering</p><p>2.For the pre-selected bubbles, check their content is similar</p><ul><li>$\Rightarrow$ Detect stable points and extract the patches around them <img data-proofer-ignore data-src="https://i.imgur.com/YmgFLav.png" alt="" /> <img data-proofer-ignore data-src="https://i.imgur.com/zmSqLzZ.png" alt="" /><li>Compare (match) those patches <img data-proofer-ignore data-src="https://i.imgur.com/Uzm6ihK.png" alt="" /> <img data-proofer-ignore data-src="https://i.imgur.com/UQWmc6N.png" alt="" /></ul><h1 id="image-descriptors">Image descriptors</h1><h2 id="issues-with-method-based-on-pixel-comparison">Issues with method based on pixel comparison<a href="#issues-with-method-based-on-pixel-comparison"><i class="fas fa-hashtag"></i></a></h2></h2><p>What is important ? What do they consider? <strong>Raw pixels!</strong></p><ul><li>We want to be able to make use of <strong>domain knowledge</strong><li><blockquote><p>Like sensitivity to shape, or dominant color information</p></blockquote></ul><h2 id="overview">Overview<a href="#overview"><i class="fas fa-hashtag"></i></a></h2></h2><p>Different sizes and contents</p><ul><li>Different kinds of descriptors</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/pLlx1Rd.png" alt="" /></p><p>Different problems $\Rightarrow$ Different choices</p><ul><li>Computation/memory constraints<li>Which perturbations do we have to tolerate ?</ul><h1 id="global-image-descriptors">Global image descriptors</h1><h2 id="two-approaches">Two approaches<a href="#two-approaches"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>Global image descriptors</strong></p><ul><li>Compute <strong>statistics about the content</strong> of the image<li>Produce a <strong>single global vector</strong></ul><div class="alert alert-info" role="alert"><p>Very attractive because they are very fast to compute and match, but…</p></div><p><strong>Bag of Features techniques</strong> (lecture 4)</p><ul><li><strong>Select regions</strong> of interest in the image (may be a variable quantity)<li>Compute descriptors for each region<li>Index each part separately (like a text seach engine which indexes words)</ul><blockquote><p>It is always possible to build a sing descriptors from multiple ones</p></blockquote><h2 id="color-histograms">Color histograms<a href="#color-histograms"><i class="fas fa-hashtag"></i></a></h2></h2><p>High invariance to many transformation</p><blockquote><p>rotation, scaling thanks to normalization, perspective But limited discriminative power</p></blockquote><p><strong>Easy to implement</strong></p><ol><li>Reduce the colors (opt. when performing backprojection)<li>Compute a reduced color histogram on each image<li>Use a distribution distance to compare the descriptors</ol><h3 id="some-results-on-twin-it">Some results on <em>Twin It!</em><a href="#some-results-on-twin-it"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-proofer-ignore data-src="https://i.imgur.com/1c2fPAo.jpg" alt="" /></p><h3 id="steps-by-step">Steps by step<a href="#steps-by-step"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="1-color-reduction">1: Color reduction<a href="#1-color-reduction"><i class="fas fa-hashtag"></i></a></h4></h4><ol><li>use K-Means or any other clustering technique to find <em>N</em> useful colors<li>Project each pixels</ol><p><img data-proofer-ignore data-src="https://i.imgur.com/ohG04XD.jpg" alt="" /></p><div class="alert alert-warning" role="alert"><p><strong>One possible result</strong> on the <em>Twin It!</em> poster</p></div><h4 id="2-histogram-computation">2: Histogram computation<a href="#2-histogram-computation"><i class="fas fa-hashtag"></i></a></h4></h4><p>You already know it (<em>Normalize it</em>)</p><p><img data-proofer-ignore data-src="https://i.imgur.com/SPYYQlQ.png" alt="" /></p><h4 id="3-descriptor-comparison">3: Descriptor comparison<a href="#3-descriptor-comparison"><i class="fas fa-hashtag"></i></a></h4></h4><p><img data-proofer-ignore data-src="https://i.imgur.com/ZP3GDlZ.png" alt="" /></p><h1 id="other-global-image-descriptor">Other global image descriptor</h1><h2 id="more-global-descriptors">More global descriptors<a href="#more-global-descriptors"><i class="fas fa-hashtag"></i></a></h2></h2><p>GIST of a scene:</p><ul><li>Oliva, Torralba, “Modeling the shape of the scene”</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/GGvNF8M.png" alt="" /></p><h1 id="global-descriptors">Global descriptors</h1><h2 id="drawback">Drawback<a href="#drawback"><i class="fas fa-hashtag"></i></a></h2></h2><p><em>Accordin to F. Perronnin:</em> Highly efficient to compute and to match $\Rightarrow$ <strong>perfect in theory</strong></p><div class="alert alert-warning" role="alert"><p>But robusteness vs informativeness tradeoff is hard to set</p></div><p>(personal conclusion)</p><ul><li>Approache based on <strong>global image descriptors</strong> are confined to <strong>near-duplicate detection</strong> applications until now<li>Modern search engine uses local representations and leverage them</ul><h1 id="clustering">Clustering</h1><h2 id="finding-groups-in-data">Finding groups in data<a href="#finding-groups-in-data"><i class="fas fa-hashtag"></i></a></h2></h2><p>Many techniques:</p><ul><li>Connectivity models<ul><li>hierarchical clustering,…<li>clustering = set of neighbors</ul><li>Centroid models: k-means<ul><li>cluster = centroid point</ul><li>Distribution model<ul><li>Gaussian mixtures models est. w. Expection maxim<li>cluster = statistical distribution</ul><li>Density models<li>Graph-based models</ul><p>Always the same goal:</p><ul><li>Minimise the differences between elements within the same cluster<li>Maximise the differences between elements within different cluster</ul><p>Number of clusters:</p><ul><li>Many methods require to choose it beforehand<li>Several techniques to adjust the number of clusters automatically</ul><p>Outliers rejection:</p><ul><li>Some techniques do not assign lonely points to any cluster</ul><div class="alert alert-success" role="alert"><p>Focus on HAC and K-Means today</p></div><h1 id="hierarchical-agglomerative-clustering">Hierarchical Agglomerative Clustering</h1><p><img data-proofer-ignore data-src="https://i.imgur.com/wOxBd2O.png" alt="" /></p><h2 id="some-linkage-types">Some linkage types<a href="#some-linkage-types"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>Single linkage<ul><li>minimizes the distance between the closest observations</ul><li>Maximum or complete linkage<li>Average linkage<li>Centroid linkage<li>Waard criterion</ul><h2 id="divisive-clustering">Divisive clustering<a href="#divisive-clustering"><i class="fas fa-hashtag"></i></a></h2></h2><p>HAC is <em>bottom-up</em>, divisive clustering is <em>top-down</em> Classical approach:</p><ol><li>Start with all data<li>Apply flat clustering<li>Recursively apply the approach on each cluster until some termination</ol><p>Pros: can have more than 2 sub-trees, must faster than HAC Cons: same issues as flat clustering, non-determinism</p><h1 id="k-means">K-means</h1><h2 id="k-mean-clustering-again">K-Mean clustering (again)<a href="#k-mean-clustering-again"><i class="fas fa-hashtag"></i></a></h2></h2><div class="alert alert-info" role="alert"><p>The K-means algorithm aims to choose centroids that minimise the inertia, or within-cluster sum-of-squares criterion</p><p><img data-proofer-ignore data-src="https://i.imgur.com/uWZCcSl.png" alt="" /></p></div><ul><li>it does not maximizes inter-cluster disantce<li>it puts centers so as to get the best coverage (may not be on a density peak !)</ul><h3 id="algorithm">Algorithm<a href="#algorithm"><i class="fas fa-hashtag"></i></a></h3></h3><p>Initialization:</p><ul><li>Randomly selected cluster centers<li>Calculate distance oiunts $\Leftrightarrow$ centers<li>Assign each point to closest center<li>Update cluster centers: avg of points</ul><p>Result: centroid centers</p><ul><li>local maximax<li>tessellation / Voronoi set over the dataset</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/MsQrOMB.png" alt="" /></p><p>The previous algorithm is called “<strong>Batch K-Means</strong>” or simply “<strong>K-Means</strong>” because it considers the <strong>whole dataset at each iteration</strong>.</p><p>Batcj K-Means is not only <strong>sensible to outliers</strong> and <strong>initialization</strong>, it is also <strong>very slow</strong> to compute on large datasets..</p><p>It is possible to avoid this speed/memory issue by <strong>randomly smapling the dataset at each step</strong>.</p><ul><li>Results are only slightly worse<li>Speed and memory requirements make it usable on bigger datasets<li>This approach is call “<strong>Online K-Means</strong>” or “<strong>MiniBatch K-Means</strong>”</ul><h2 id="application-color-quantization">Application: Color quantization<a href="#application-color-quantization"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/acFEo2s.png" alt="" /></p><h2 id="many-clustering-techniques-to-play-with-">Many clustering techniques to play with !<a href="#many-clustering-techniques-to-play-with-"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/GEU50Xd.png" alt="" /></p><h1 id="evaluation-of-clustering">Evaluation of clustering</h1><h2 id="need-some-supervision-">Need some supervision ?<a href="#need-some-supervision-"><i class="fas fa-hashtag"></i></a></h2></h2><p>By construction, clustering algorithms are optimal as they are expect to find some optimal balance between high intra-cluster similarity and low inter-cluster similarity, on their training set.</p><p>How do these internal criteria translate into good effectiveness for applications ?</p><p>A common approach is to rely on labeled data to compute new indicators:</p><ul><li>Purity: sort of “agreement” inside each cluster<li>Normalized Mutual Information (NMI) and Entropu: information measures<li>Rand Index (RI) and F measure: error counts</ul><h2 id="modern-density-estimation-point-of-view">Modern density estimation point of view<a href="#modern-density-estimation-point-of-view"><i class="fas fa-hashtag"></i></a></h2></h2><p>But what about if we leave some samples out for testing the generalization ?</p><p>HAC or K-Means “overfit” the underlying data distribution.</p><p>It does not alway make sense, but if we are interested in density estimation, then we can assess how well our model estimates the probability $P(x)$ of unseen data. The “E” step of the EM algo is based on this idea.</p><h1 id="local-feature-detectors">Local feature detectors</h1><h2 id="introduction-1">Introduction<a href="#introduction-1"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>How are panorama pictures created from multiple pictures ?</p></blockquote><p><img data-proofer-ignore data-src="https://i.imgur.com/gGQi6VP.png" alt="" /></p><ol><li>Detect small parts invariant under viewpoint change: “Keypoints” <img data-proofer-ignore data-src="https://i.imgur.com/pQK2QNY.png" alt="" /><li>Find pairs of amthcing keypoints using a description of their neighborhood<li>Compute the most likely transformation to blend images together</ol><h2 id="some-classical-detectors">Some classical detectors<a href="#some-classical-detectors"><i class="fas fa-hashtag"></i></a></h2></h2><p>Edge (gradient detectors)</p><ul><li>Soble<li>Canny</ul><h1 id="edge-detectors">Edge detectors</h1><h2 id="whats-an-edge-">What’s an edge ?<a href="#whats-an-edge-"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>Image is a function<li>Edges are rapid changes in thi function<li>The derivative of a function exhibits the edges</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/zEYXFac.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/bk8ZLcB.png" alt="" /></p><div class="alert alert-info" role="alert"><p>Gris = elevation comme dans le watershed</p></div><h2 id="image-derivatives">Image derivatives<a href="#image-derivatives"><i class="fas fa-hashtag"></i></a></h2></h2><p>Recall:</p><p><img data-proofer-ignore data-src="https://i.imgur.com/GOiWeYU.png" alt="" /></p><ul><li>We don’t have an “actual” function, must estimate<li>Possibility: set $h=1$<li><div class="table-wrapper"><table><tbody><tr><td>Apply filter<td>-1<td>0<td>+1<td>to the image ($x$ gradient)</table></div></ul><p><img data-proofer-ignore data-src="https://i.imgur.com/k3b1Jkz.png" alt="" /></p><div class="alert alert-success" role="alert"><p>We get terribly spiky results</p></div><p>We need to interpolate/smooth</p><ul><li>Gaussian filter</ul><p>We get a sobel filter</p><p><img data-proofer-ignore data-src="https://i.imgur.com/rIHqWke.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/VXGlNR0.png" alt="" /></p><h2 id="sobel-filter">Sobel filter<a href="#sobel-filter"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/QYCNAO3.png" alt="" /></p><h2 id="gradient-magnitude-with-sobel">Gradient magnitude with Sobel<a href="#gradient-magnitude-with-sobel"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/z3SOgYg.png" alt="" /></p><h2 id="canny-edge-detection">Canny edge detection<a href="#canny-edge-detection"><i class="fas fa-hashtag"></i></a></h2></h2><div class="alert alert-info" role="alert"><p>Extract real lines !</p></div><h3 id="non-maximum-suppression">Non-maximum suppression<a href="#non-maximum-suppression"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-proofer-ignore data-src="https://i.imgur.com/jA3uwmy.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/B79XXLk.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/B2BL2eX.png" alt="" /></p><h3 id="finalization">Finalization<a href="#finalization"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-proofer-ignore data-src="https://i.imgur.com/bGO4YCe.png" alt="" /></p><h1 id="corner-detectors">Corner detectors</h1><h2 id="good-features">Good features<a href="#good-features"><i class="fas fa-hashtag"></i></a></h2></h2><p>Good features are unique!</p><ul><li>Can find the “same” feature easily<li>Not mistaken for “different” features</ul><p>Good features are robust under perturbation</p><ul><li>Can detect them under translation, rotation<li>Intensity shift<li>Noise</ul><h2 id="how-can-we-find-unique-patches-">How can we find unique patches ?<a href="#how-can-we-find-unique-patches-"><i class="fas fa-hashtag"></i></a></h2></h2><p>Sky? Bad!</p><ul><li>Very little variation Edge? OK Corners? Good!</ul><p><img data-proofer-ignore data-src="https://i.imgur.com/d2wxBTr.png" alt="" /></p><h2 id="self-difference">Self-difference<a href="#self-difference"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-proofer-ignore data-src="https://i.imgur.com/UFz6Eey.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/7TeRwBZ.jpg" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.comq2u4Sc.png" alt="" /></p><h2 id="harris-corner-detector">Harris corner detector<a href="#harris-corner-detector"><i class="fas fa-hashtag"></i></a></h2></h2><div class="alert alert-info" role="alert"><p>Naive computation:</p><p><img data-proofer-ignore data-src="https://i.imgur.com/GuM7zyB.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/ROWWgQv.png" alt="" /></p></div><blockquote><p>Bon a partir de maintenant c’est que des screens parce que le prof trace</p></blockquote><p><img data-proofer-ignore data-src="https://i.imgur.com/uPIIC8u.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/Gs4gDUJ.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/3sEA6um.png" alt="" /></p><p>This allows us to “simplify” the original equation</p><p><img data-proofer-ignore data-src="https://i.imgur.com/HM1yPdt.png" alt="" /></p><p>and more important making it <strong>faster to compute</strong>, thanks to simpler derivatives which can be <strong>computed for the whole image</strong>.</p><p>If we developp the equation and write it as usual matrix form, we get: <img data-proofer-ignore data-src="https://i.imgur.com/HfuTWn3.png" alt="" /></p><p>where $A(x,y)$ is the structure tensor:</p><p><img data-proofer-ignore data-src="https://i.imgur.com/MPPJwRD.png" alt="" /></p><p>This trick is useful because $I_x$ and $I_y$ can be computed very simply.</p><p><img data-proofer-ignore data-src="https://i.imgur.com/1mI6CEC.jpg" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/23vb2Xg.png" alt="" /></p><div class="alert alert-danger" role="alert"><p>The need for <strong>eigenvalues</strong> If the edge is rotated, so are the values of $I_x$ and $I_y$. Eigenvalues give us the ellipsis axis lens.</p></div><p><img data-proofer-ignore data-src="https://i.imgur.com/K0lYoMy.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/ZRsWaTA.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/3tNu1L9.png" alt="" /></p><h3 id="summary">Summary<a href="#summary"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-proofer-ignore data-src="https://i.imgur.com/SSCDJz6.png" alt="" /></p><p><img data-proofer-ignore data-src="https://i.imgur.com/Y6jAik7.png" alt="" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/cours/categories/image-s8/'>Image S8</a>, <a href='/cours/categories/mlrf/'>MLRF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/cours/tags/image/" class="post-tag no-text-decoration" >Image</a> <a href="/cours/tags/scia/" class="post-tag no-text-decoration" >SCIA</a> <a href="/cours/tags/mlrf/" class="post-tag no-text-decoration" >MLRF</a> <a href="/cours/tags/s8/" class="post-tag no-text-decoration" >S8</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MLRF: Lecture 02 - Cours&url=https://lemasyma.github.io/cours/posts/mlrf_second_course/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MLRF: Lecture 02 - Cours&u=https://lemasyma.github.io/cours/posts/mlrf_second_course/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=MLRF: Lecture 02 - Cours&url=https://lemasyma.github.io/cours/posts/mlrf_second_course/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/cours/posts/ocvx_norme/">OCVX: Norme</a><li><a href="/cours/posts/imed2_tp3/">IMED2: TP3</a><li><a href="/cours/posts/prsta_revisions_1/">PRSTA: Revisions 1</a><li><a href="/cours/posts/prsta_td5/">PRSTA: TD 5</a><li><a href="/cours/posts/prsta_td4/">PRSTA: TD 4</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/cours/tags/image/">Image</a> <a class="post-tag" href="/cours/tags/s8/">S8</a> <a class="post-tag" href="/cours/tags/s9/">S9</a> <a class="post-tag" href="/cours/tags/tronc-commun/">tronc commun</a> <a class="post-tag" href="/cours/tags/scia/">SCIA</a> <a class="post-tag" href="/cours/tags/s6/">S6</a> <a class="post-tag" href="/cours/tags/shannon/">Shannon</a> <a class="post-tag" href="/cours/tags/cama/">CAMA</a> <a class="post-tag" href="/cours/tags/loi/">loi</a> <a class="post-tag" href="/cours/tags/rvau/">RVAU</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/cours/posts/mlrf_first_course/"><div class="card-body"> <em class="timeago small" date="2021-05-14 10:00:00 +0200" >May 14, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MLRF: Lecture 01</h3><div class="text-muted small"><p> Lien de la note Hackmd Scope of this course Apply Machine Learning (ML) techniques to solve some practical Computer Vision (CV) problems About Computer Vision (CV) It should be called C...</p></div></div></a></div><div class="card"> <a href="/cours/posts/mlrf_third_course/"><div class="card-body"> <em class="timeago small" date="2021-05-28 10:00:00 +0200" >May 28, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MLRF: Lecture 03</h3><div class="text-muted small"><p> Lien de la note Hackmd Agenda for lecture 3 Introduction Finish lecture about local feature detectors Local feature descriptors Descriptor matching and indexing Projective transformatio...</p></div></div></a></div><div class="card"> <a href="/cours/posts/mlrf_fourth_course/"><div class="card-body"> <em class="timeago small" date="2021-06-04 10:00:00 +0200" >Jun 4, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MLRF: Lecture 04</h3><div class="text-muted small"><p> Lien de la note Hackmd Agenda for lecture 4 Introduction Content-based image retrievalasl (CBIR) using bags of features Evaluating CBIR / Ranked Retrieval (RR) systems Texture descriptor...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/cours/posts/ase3_td_1/" class="btn btn-outline-primary" prompt="Older"><p>ASE3: TD 1</p></a> <a href="/cours/posts/rse_2/" class="btn btn-outline-primary" prompt="Newer"><p>RSE: Deuxieme cours</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/lemasyma">lemasyma</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/cours/tags/image/">Image</a> <a class="post-tag" href="/cours/tags/s8/">S8</a> <a class="post-tag" href="/cours/tags/s9/">S9</a> <a class="post-tag" href="/cours/tags/tronc-commun/">tronc commun</a> <a class="post-tag" href="/cours/tags/scia/">SCIA</a> <a class="post-tag" href="/cours/tags/s6/">S6</a> <a class="post-tag" href="/cours/tags/shannon/">Shannon</a> <a class="post-tag" href="/cours/tags/cama/">CAMA</a> <a class="post-tag" href="/cours/tags/loi/">loi</a> <a class="post-tag" href="/cours/tags/rvau/">RVAU</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/cours/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/cours/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/cours/assets/js/dist/post.min.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" }, tagSide: "right" }, tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], displayMath: [ ['$$','$$'], ["\\[","\\]"] ], processEscapes: true }, CommonHTML: { linebreaks: { automatic: true } }, "HTML-CSS": { linebreaks: { automatic: true } }, SVG: { linebreaks: { automatic: true } } }); MathJax.Hub.Register.StartupHook("TeX AMSmath Ready", function () { MathJax.InputJax.TeX.Stack.Item.AMSarray.Augment({ clearTag() { if (!this.global.notags) { this.super(arguments).clearTag.call(this); } } }); }); </script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script type="text/javascript" charset="utf-8" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/cours/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-PVWXSNG5J8"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-PVWXSNG5J8'); }); </script>
